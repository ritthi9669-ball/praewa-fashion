<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Praewa Fashion | ‡∏™‡∏ß‡∏¢ ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à ‡∏ó‡∏∏‡∏Å‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&family=Sriracha&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #f472b6; --accent: #fbcfe8; --bg: #fff5f7; 
            --text: #502d3c; --muted: #9d7c8a; --white: #ffffff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Prompt', sans-serif; background-color: var(--bg); color: var(--text); overflow-x: hidden; }
        button { cursor: pointer; border: none; font-family: inherit; transition: 0.2s; border-radius: 12px; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

        /* Header & Nav */
        header { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border-bottom: 2px solid var(--accent); position: sticky; top: 0; z-index: 1000; }
        .nav-top { height: 70px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-family: 'Sriracha', cursive; font-size: 32px; color: var(--primary); text-decoration: none; }
        
        .nav-menu { display: flex; justify-content: center; gap: 20px; list-style: none; font-size: 13px; padding: 10px 0; border-top: 1px solid #fdf2f8; }
        .nav-menu li a { text-decoration: none; color: var(--text); font-weight: 500; }
        .nav-menu li a:hover { color: var(--primary); }

        .icon-group { display: flex; gap: 15px; }
        .nav-icon { font-size: 18px; color: var(--primary); position: relative; background: none; }
        .badge { position: absolute; top: -5px; right: -5px; background: #ff4785; color: white; font-size: 10px; width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }

        /* Admin Toolbar - ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô */
        .admin-bar { background: var(--text); color: white; padding: 12px 0; font-size: 14px; display: none; border-bottom: 3px solid var(--primary); }
        .admin-bar.active { display: block; }
        .admin-btn { background: var(--primary); color: white; padding: 6px 15px; border-radius: 8px; font-size: 12px; font-weight: 600; margin-left: 10px; }
        .admin-btn:hover { background: #db2777; }

        /* Page Transitions */
        .page { display: none; padding-top: 30px; animation: fadeIn 0.4s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Hero */
        .hero { height: 350px; background: linear-gradient(rgba(255,245,247,0.2), rgba(255,245,247,0.2)), url('https://images.unsplash.com/photo-1490481651871-ab68de25d43d?w=1200') center/cover; border-radius: 30px; display: flex; align-items: center; justify-content: center; margin-bottom: 40px; }
        .hero-card { background: white; padding: 30px; border-radius: 25px; text-align: center; box-shadow: 0 10px 30px rgba(244, 114, 182, 0.2); }

        /* Shop Layout */
        .shop-layout { display: grid; grid-template-columns: 240px 1fr; gap: 30px; }
        .sidebar { background: white; padding: 20px; border-radius: 20px; height: fit-content; }
        .side-title { font-weight: 600; margin-bottom: 15px; border-bottom: 2px solid var(--bg); padding-bottom: 5px; }
        .cat-list { list-style: none; }
        .cat-list li { padding: 8px 0; cursor: pointer; font-size: 14px; transition: 0.2s; }
        .cat-list li:hover { color: var(--primary); padding-left: 5px; }
        .cat-list li.active { color: var(--primary); font-weight: 600; }

        /* Grid */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .p-card { background: white; border-radius: 20px; overflow: hidden; position: relative; border: 1px solid transparent; transition: 0.3s; }
        .p-card:hover { border-color: var(--primary); transform: translateY(-5px); }
        .p-img { aspect-ratio: 3/4; overflow: hidden; background: #fafafa; cursor: pointer; }
        .p-img img { width: 100%; height: 100%; object-fit: cover; }
        .p-info { padding: 15px; text-align: center; }
        .p-price { color: var(--primary); font-weight: 600; }

        /* Add Card Placeholder */
        .add-card { border: 2px dashed var(--primary); display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(244, 114, 182, 0.05); color: var(--primary); min-height: 300px; cursor: pointer; border-radius: 20px; }
        .add-card:hover { background: rgba(244, 114, 182, 0.1); }

        /* Product Detail */
        .detail-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; background: white; padding: 40px; border-radius: 30px; }
        .option-group { margin-top: 20px; }
        .opt-title { font-size: 13px; font-weight: 600; margin-bottom: 10px; display: block; }
        .size-box { display: flex; gap: 10px; }
        .size-btn { border: 1px solid #ddd; padding: 5px 12px; border-radius: 8px; background: white; font-size: 12px; }
        .size-btn.selected { border-color: var(--primary); background: var(--bg); color: var(--primary); }

        /* Modals */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 2000; display: none; align-items: center; justify-content: center; padding: 20px; }
        .modal { background: white; width: 100%; max-width: 450px; border-radius: 25px; padding: 30px; position: relative; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 12px; margin-bottom: 5px; font-weight: 600; }
        .form-group input, .form-group select { width: 100%; padding: 12px; border: 1px solid #eee; border-radius: 10px; outline: none; }
        .btn-block { width: 100%; padding: 12px; background: var(--primary); color: white; font-weight: 600; border-radius: 12px; margin-top: 10px; }

        .btn-del { position: absolute; top: 10px; right: 10px; background: #f87171; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; z-index: 10; }

        footer { text-align: center; padding: 60px 0; border-top: 4px solid var(--accent); margin-top: 80px; font-size: 12px; color: var(--muted); }
    </style>
</head>
<body>

    <!-- ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô -->
    <div id="adminBar" class="admin-bar">
        <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <span><i class="fas fa-user-shield"></i> ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö: <b>Praewa Fashion Admin</b></span>
            <div>
                <button onclick="openConfig()" class="admin-btn" style="background:#4b5563;">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API</button>
                <button onclick="openAddModal()" class="admin-btn">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
                <button onclick="logoutAdmin()" class="admin-btn" style="background:#ef4444;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
        </div>
    </div>

    <header>
        <div class="container nav-container">
            <div class="nav-top">
                <button onclick="openLogin()" class="nav-icon" title="‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô"><i class="fas fa-cog"></i></button>
                <a href="#" onclick="showPage('home')" class="logo">Praewa Fashion</a>
                <div class="icon-group">
                    <button class="nav-icon"><i class="fas fa-search"></i></button>
                    <button class="nav-icon" onclick="showPage('cart')">
                        <i class="fas fa-shopping-bag"></i>
                        <span id="cartCount" class="badge" style="display:none;">0</span>
                    </button>
                </div>
            </div>
            <ul class="nav-menu">
                <li><a href="#" onclick="showPage('home')">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
                <li><a href="#" onclick="showPage('shop')">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
                <li><a href="#">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</a></li>
                <li><a href="#">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</a></li>
                <li><a href="#">‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</a></li>
                <li><a href="#">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
            </ul>
        </div>
    </header>

    <div class="container">
        
        <!-- Home Page -->
        <div id="homePage" class="page active">
            <div class="hero">
                <div class="hero-card">
                    <p style="text-transform: uppercase; font-size: 12px; letter-spacing: 2px;">Welcome to Praewa</p>
                    <h1 style="font-family: 'Sriracha'; color: var(--primary); font-size: 42px;">New Collection</h1>
                    <p style="color: var(--muted); margin-bottom: 20px;">‡∏™‡∏ß‡∏¢ ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à ‡∏ó‡∏∏‡∏Å‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                    <button class="btn-block" style="width: auto; padding: 12px 30px;" onclick="showPage('shop')">‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                </div>
            </div>
            <h2 style="font-family: 'Sriracha'; text-align: center; margin-bottom: 30px;">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h2>
            <div id="featuredGrid" class="product-grid"></div>
        </div>

        <!-- Shop Page -->
        <div id="shopPage" class="page">
            <div class="shop-layout">
                <aside class="sidebar">
                    <div class="side-title">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
                    <ul class="cat-list">
                        <li class="active" onclick="filterCat('‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</li>
                        <li onclick="filterCat('‡πÄ‡∏î‡∏£‡∏™')">‡πÄ‡∏î‡∏£‡∏™</li>
                        <li onclick="filterCat('‡πÄ‡∏™‡∏∑‡πâ‡∏≠')">‡πÄ‡∏™‡∏∑‡πâ‡∏≠</li>
                        <li onclick="filterCat('‡∏Å‡∏£‡∏∞‡πÇ‡∏õ‡∏£‡∏á')">‡∏Å‡∏£‡∏∞‡πÇ‡∏õ‡∏£‡∏á</li>
                        <li onclick="filterCat('‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á')">‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á</li>
                    </ul>
                </aside>
                <main>
                    <div id="mainGrid" class="product-grid"></div>
                </main>
            </div>
        </div>

        <!-- Product Detail Page -->
        <div id="detailPage" class="page">
            <div class="detail-grid">
                <div style="border-radius: 20px; overflow: hidden; background: #fafafa; aspect-ratio: 3/4;">
                    <img id="detailImg" src="" style="width: 100%; height: 100%; object-fit: cover;">
                </div>
                <div class="detail-info">
                    <h1 id="detailName" style="font-family: 'Sriracha'; color: var(--primary);"></h1>
                    <p id="detailCat" style="color: var(--muted); font-size: 14px;"></p>
                    <h2 id="detailPrice" style="margin: 20px 0; color: var(--text);"></h2>
                    
                    <div class="option-group">
                        <span class="opt-title">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ã‡∏™‡πå (Size)</span>
                        <div class="size-box">
                            <button class="size-btn">S</button>
                            <button class="size-btn selected">M</button>
                            <button class="size-btn">L</button>
                            <button class="size-btn">XL</button>
                        </div>
                    </div>

                    <button class="btn-block" onclick="addToCart()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
                    <button class="btn-block" style="background: none; color: var(--muted); border: 1px solid #ddd;" onclick="showPage('shop')">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ä‡πâ‡∏≠‡∏õ‡∏ï‡πà‡∏≠</button>
                </div>
            </div>
        </div>

        <!-- Cart Page -->
        <div id="cartPage" class="page">
            <h1 style="font-family: 'Sriracha'; margin-bottom: 30px;">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h1>
            <div style="background: white; border-radius: 20px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.02);">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead style="text-align: left; border-bottom: 1px solid #eee;">
                        <tr><th style="padding: 15px;">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th><th style="padding: 15px;">‡∏£‡∏≤‡∏Ñ‡∏≤</th><th style="padding: 15px;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr>
                    </thead>
                    <tbody id="cartItems"></tbody>
                </table>
            </div>
            <div style="background: white; padding: 30px; border-radius: 20px; margin-top: 30px; text-align: right;">
                <p style="font-size: 20px; font-weight: 600;">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô: <span id="cartTotal" style="color: var(--primary);">‡∏ø 0</span></p>
                <button class="btn-block" style="max-width: 250px; margin-left: auto;" onclick="alert('‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏ó‡∏µ‡πà Excel ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì')">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
            </div>
        </div>

    </div>

    <!-- Modals -->
    <div id="loginModal" class="modal-overlay">
        <div class="modal" style="max-width: 320px;">
            <h3 style="margin-bottom: 20px; text-align: center; color: var(--primary);">‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</h3>
            <input type="password" id="adminPass" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (admin1234)" style="width:100%; padding:12px; margin-bottom:15px; border-radius:10px; border:1px solid #eee;">
            <button class="btn-block" onclick="doLogin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
            <button class="btn-block" style="background:none; color:#999; margin-top: 10px;" onclick="closeModals()">‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</button>
        </div>
    </div>

    <div id="addModal" class="modal-overlay">
        <div class="modal">
            <h3 style="margin-bottom: 20px; color: var(--primary);">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏•‡∏á Excel</h3>
            <div class="form-group">
                <label>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                <input type="text" id="pName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏î‡∏£‡∏™‡∏™‡∏±‡πâ‡∏ô‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π">
            </div>
            <div class="form-group">
                <label>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                <input type="number" id="pPrice" placeholder="590">
            </div>
            <div class="form-group">
                <label>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                <select id="pCat">
                    <option value="‡πÄ‡∏î‡∏£‡∏™">‡πÄ‡∏î‡∏£‡∏™</option>
                    <option value="‡πÄ‡∏™‡∏∑‡πâ‡∏≠">‡πÄ‡∏™‡∏∑‡πâ‡∏≠</option>
                    <option value="‡∏Å‡∏£‡∏∞‡πÇ‡∏õ‡∏£‡∏á">‡∏Å‡∏£‡∏∞‡πÇ‡∏õ‡∏£‡∏á</option>
                    <option value="‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á">‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á</option>
                </select>
            </div>
            <div class="form-group">
                <label>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û URL</label>
                <input type="text" id="pImg" placeholder="https://images.unsplash.com/...">
            </div>
            <button class="btn-block" onclick="saveToExcel()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Excel</button>
            <button class="btn-block" style="background:none; color:#999;" onclick="closeModals()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
    </div>

    <div id="configModal" class="modal-overlay">
        <div class="modal">
            <h3 style="margin-bottom: 15px;">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h3>
            <p style="font-size: 12px; color: var(--muted); margin-bottom: 15px;">‡∏ß‡∏≤‡∏á Web App URL ‡∏à‡∏≤‡∏Å Google Apps Script ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Deploy ‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡∏ö</p>
            <input type="text" id="apiUrlInp" placeholder="https://script.google.com/macros/s/..." style="width:100%; padding:12px; margin-bottom: 15px; border: 1px solid #eee; border-radius: 10px;">
            <button class="btn-block" onclick="saveApiUrl()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å API</button>
        </div>
    </div>

    <div id="loader" style="position:fixed; inset:0; background:rgba(255,255,255,0.9); z-index:3000; display:none; flex-direction:column; align-items:center; justify-content:center;">
        <i class="fas fa-heart fa-beat" style="font-size: 50px; color: var(--primary);"></i>
        <p style="margin-top:20px; font-weight: 500;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Excel...</p>
    </div>

    <footer>
        <span class="logo" style="font-size: 24px;">Praewa Fashion</span>
        <p>&copy; 2026 ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ | ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Excel ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
    </footer>

    <script>
        let products = [];
        let cart = [];
        let activeCat = '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
        let isAdmin = false;
        let selectedProduct = null;
        let apiUrl = localStorage.getItem('praewa_api_url') || '';

        async function init() {
            if (!apiUrl) {
                products = [{ Name: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô', Price: 0, Category: '‡πÄ‡∏î‡∏£‡∏™', Image: '', ID: 'demo' }];
                renderProducts();
                return;
            }
            showLoader(true);
            try {
                const res = await fetch(apiUrl);
                products = await res.json();
                renderProducts();
            } catch (e) { alert("‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API URL"); }
            showLoader(false);
        }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            const target = document.getElementById(pageId + 'Page');
            if(target) target.classList.add('active');
            window.scrollTo(0, 0);
        }

        function renderProducts() {
            const mainGrid = document.getElementById('mainGrid');
            const featuredGrid = document.getElementById('featuredGrid');
            
            const filtered = activeCat === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î' ? products : products.filter(p => p.Category === activeCat);
            
            let html = filtered.map(p => `
                <div class="p-card">
                    <div class="p-img" onclick="viewDetail('${p.ID}')">
                        <img src="${p.Image || 'https://via.placeholder.com/300x400?text=No+Image'}" alt="${p.Name}">
                    </div>
                    ${isAdmin ? `<button class="btn-del" onclick="deleteItem('${p.ID}')" title="‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ"><i class="fas fa-trash"></i></button>` : ''}
                    <div class="p-info">
                        <div style="font-size:11px; color:var(--primary); font-weight:600;">${p.Category}</div>
                        <div style="font-size:14px; font-weight:500; margin: 5px 0;">${p.Name}</div>
                        <div class="p-price">‡∏ø ${Number(p.Price || 0).toLocaleString()}</div>
                    </div>
                </div>
            `).join('');

            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
            if (isAdmin && (activeCat === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î' || activeCat)) {
                html += `
                    <div class="add-card" onclick="openAddModal()">
                        <i class="fas fa-plus-circle" style="font-size: 40px; margin-bottom: 10px;"></i>
                        <span style="font-weight: 600;">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</span>
                    </div>
                `;
            }

            if(mainGrid) mainGrid.innerHTML = html;
            if(featuredGrid) featuredGrid.innerHTML = html;
        }

        function viewDetail(id) {
            const p = products.find(x => x.ID == id);
            if (!p) return;
            selectedProduct = p;
            document.getElementById('detailName').innerText = p.Name;
            document.getElementById('detailCat').innerText = p.Category;
            document.getElementById('detailPrice').innerText = '‡∏ø ' + Number(p.Price).toLocaleString();
            document.getElementById('detailImg').src = p.Image || '';
            showPage('detail');
        }

        function addToCart() {
            if(!selectedProduct) return;
            cart.push(selectedProduct);
            updateCartUI();
            alert("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ üíñ");
        }

        function updateCartUI() {
            const list = document.getElementById('cartItems');
            const totalEl = document.getElementById('cartTotal');
            const badge = document.getElementById('cartCount');
            let total = 0;
            
            if(list) {
                list.innerHTML = cart.map((item, i) => {
                    total += Number(item.Price);
                    return `<tr style="border-bottom: 1px solid #f9f9f9;">
                        <td style="padding: 15px;"><div style="display:flex; gap:15px; align-items:center;"><img src="${item.Image}" width="50" height="60" style="object-fit:cover; border-radius:8px;"><b>${item.Name}</b></div></td>
                        <td style="padding: 15px;">‡∏ø ${Number(item.Price).toLocaleString()}</td>
                        <td style="padding: 15px;"><button onclick="removeFromCart(${i})" style="background:none; color:#f87171;"><i class="fas fa-trash-alt"></i></button></td>
                    </tr>`;
                }).join('');
            }

            if(badge) {
                badge.innerText = cart.length;
                badge.style.display = cart.length > 0 ? 'flex' : 'none';
            }
            if(totalEl) totalEl.innerText = '‡∏ø ' + total.toLocaleString();
        }

        function removeFromCart(i) { cart.splice(i, 1); updateCartUI(); }

        function filterCat(cat) {
            activeCat = cat;
            document.querySelectorAll('.cat-list li').forEach(li => li.classList.toggle('active', li.innerText === cat));
            renderProducts();
        }

        // --- ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Excel ---
        async function saveToExcel() {
            const item = {
                action: 'add',
                name: document.getElementById('pName').value,
                price: document.getElementById('pPrice').value,
                category: document.getElementById('pCat').value,
                image: document.getElementById('pImg').value,
                id: "ID-" + Date.now()
            };
            if(!item.name || !item.price) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞");
            
            showLoader(true);
            try {
                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÇ‡∏´‡∏°‡∏î no-cors ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Apps Script)
                await fetch(apiUrl, { method: 'POST', mode: 'no-cors', body: JSON.stringify(item) });
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                products.push({ Name: item.name, Price: item.price, Category: item.category, Image: item.image, ID: item.id });
                renderProducts();
                closeModals();
                alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Excel ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞! ‚ú®");
            } catch (e) { alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å"); }
            showLoader(false);
        }

        async function deleteItem(id) {
            if (!confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Excel ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞?")) return;
            showLoader(true);
            try {
                await fetch(apiUrl, { method: 'POST', mode: 'no-cors', body: JSON.stringify({ action: 'delete', id: id }) });
                products = products.filter(p => p.ID != id);
                renderProducts();
                alert("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
            } catch (e) { console.error(e); }
            showLoader(false);
        }

        // --- ‡∏£‡∏∞‡∏ö‡∏ö UI ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ---
        function openLogin() { document.getElementById('loginModal').style.display = 'flex'; }
        
        function doLogin() {
            if (document.getElementById('adminPass').value === 'admin1234') {
                isAdmin = true; 
                document.getElementById('adminBar').classList.add('active'); 
                closeModals(); 
                renderProducts();
            } else alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏∞");
        }
        
        function logoutAdmin() { 
            isAdmin = false; 
            document.getElementById('adminBar').classList.remove('active'); 
            renderProducts(); 
        }
        
        function openConfig() { 
            document.getElementById('configModal').style.display = 'flex'; 
            document.getElementById('apiUrlInp').value = apiUrl; 
        }
        
        function saveApiUrl() { 
            apiUrl = document.getElementById('apiUrlInp').value; 
            localStorage.setItem('praewa_api_url', apiUrl); 
            closeModals(); 
            init(); 
        }
        
        function openAddModal() { document.getElementById('addModal').style.display = 'flex'; }
        function closeModals() { document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none'); }
        function showLoader(s) { document.getElementById('loader').style.display = s ? 'flex' : 'none'; }

        window.onload = init;
    </script>
</body>
</html>
