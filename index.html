<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Praewa Fashion | ‡∏™‡∏ß‡∏¢ ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à ‡∏ó‡∏∏‡∏Å‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&family=Sriracha&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --primary: #f472b6; --accent: #fbcfe8; --bg: #fffcfc; 
            --text: #502d3c; --muted: #9d7c8a; --white: #ffffff;
            --success: #10b981; --danger: #f87171;
            --soft-pink: #fdf2f8;
        }

        body {
            font-family: 'Prompt', sans-serif;
            background: linear-gradient(135deg, #fff5f7 0%, #fbcfe833 100%);
            color: var(--text);
            min-height: 100vh;
        }

        .font-sriracha { font-family: 'Sriracha', cursive; }
        
        /* Decorations */
        .decor-flower { position: fixed; z-index: -1; opacity: 0.4; pointer-events: none; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade { animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        @keyframes heartbeat { 
            0%, 100% { transform: scale(1); } 
            50% { transform: scale(1.1); } 
        }
        .fa-beat-custom { animation: heartbeat 2s infinite; }

        header { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(20px); border-bottom: 2px solid var(--accent); }
        .nav-link { font-size: 13px; font-weight: 600; color: var(--muted); transition: 0.3s; position: relative; }
        .nav-link::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 0; height: 2px; background: var(--primary); transition: 0.3s; }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }
        .nav-link:hover, .nav-link.active { color: var(--primary); }

        .product-card { border-radius: 40px; transition: 0.4s ease; background: white; border: 1px solid rgba(244, 114, 182, 0.1); }
        .product-card:hover { transform: translateY(-12px); box-shadow: 0 30px 60px -15px rgba(244, 114, 182, 0.3); }
        
        .img-wrap { aspect-ratio: 3/4; border-radius: 32px; overflow: hidden; position: relative; margin: 10px; }
        .img-wrap img { transition: 1.2s; width: 100%; height: 100%; object-fit: cover; }
        .product-card:hover img { transform: scale(1.1); }

        .modal-overlay { position: fixed; inset: 0; background: rgba(80, 45, 60, 0.4); backdrop-filter: blur(8px); z-index: 2000; display: none; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: white; border-radius: 50px; width: 100%; max-width: 550px; padding: 45px; box-shadow: 0 40px 100px -20px rgba(0, 0, 0, 0.2); border: 2px solid white; }

        .btn-sweet { background: var(--primary); color: white; transition: 0.4s; box-shadow: 0 10px 25px -5px rgba(244, 114, 182, 0.5); border-radius: 99px; }
        .btn-sweet:hover { background: #db2777; transform: translateY(-3px); box-shadow: 0 15px 30px -5px rgba(244, 114, 182, 0.6); }

        .tag-stock { background: rgba(255, 255, 255, 0.9); padding: 4px 12px; border-radius: 20px; font-size: 10px; font-weight: 700; color: var(--primary); border: 1px solid var(--accent); }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 10px; }
        
        .page { display: none; } 
        .page.show { display: block !important; }
    </style>
</head>
<body>

    <div class="decor-flower" style="top: 5%; left: 2%; font-size: 60px;">üå∏</div>
    <div class="decor-flower" style="top: 40%; right: 2%; font-size: 40px;">üå∏</div>
    <div class="decor-flower" style="bottom: 10%; left: 5%; font-size: 50px;">üå∫</div>

    <div id="globalLoader" class="fixed inset-0 bg-white/90 backdrop-blur-md z-[9999] flex flex-col items-center justify-center text-rose-500" style="display: none;">
        <i class="fas fa-heart fa-beat-custom text-6xl mb-6"></i>
        <p class="font-sriracha text-2xl tracking-wide">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞...</p>
    </div>

    <div id="adminBar" class="text-white bg-stone-900 py-3 px-6 sticky top-0 z-[1001] shadow-xl" style="display: none;">
        <div class="max-w-7xl mx-auto flex justify-between items-center text-[11px]">
            <div class="flex items-center gap-6">
                <span class="text-rose-400 font-bold uppercase tracking-wider"><i class="fas fa-user-shield mr-2"></i> Admin Mode</span>
                <button onclick="openProductModal()" class="hover:text-rose-300 font-bold">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                <button onclick="openSettingsModal()" class="hover:text-rose-300 font-bold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô</button>
            </div>
            <button onclick="logoutAdmin()" class="bg-rose-500 hover:bg-rose-600 px-5 py-2 rounded-full font-bold transition-all">Logout</button>
        </div>
    </div>

    <header class="sticky top-0 z-[1000] shadow-sm">
        <div class="max-w-7xl mx-auto px-6 h-24 flex justify-between items-center gap-4">
            <div class="flex items-center gap-4 flex-1">
                <button onclick="openLoginModal()" class="p-3 text-rose-200 hover:text-rose-400 transition-all hover:bg-white rounded-full">
                    <i class="fas fa-cog text-xl"></i>
                </button>
                <div class="hidden md:flex items-center bg-white/80 border border-rose-100 rounded-full px-4 py-2 w-64">
                    <i class="fas fa-search text-rose-300 mr-2"></i>
                    <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∏‡∏î‡∏™‡∏ß‡∏¢‡πÜ..." class="bg-transparent border-none outline-none text-xs w-full" oninput="handleSearch(this.value)">
                </div>
            </div>
            
            <div class="text-center shrink-0">
                <a href="#" onclick="showPage('home')" class="text-4xl md:text-5xl font-sriracha text-rose-500 block leading-none">
                    Praewa Fashion
                </a>
            </div>

            <div class="flex items-center gap-4 flex-1 justify-end">
                <button onclick="showPage('cart')" class="relative p-4 bg-rose-500 text-white rounded-full shadow-lg group hover:scale-110 transition-all">
                    <i class="fas fa-shopping-bag text-xl"></i>
                    <span id="cartCount" class="absolute -top-1 -right-1 bg-stone-800 text-white text-[9px] w-6 h-6 rounded-full flex items-center justify-center font-bold border-2 border-white" style="display: none;">0</span>
                </button>
            </div>
        </div>
        <div class="max-w-7xl mx-auto flex justify-center gap-4 md:gap-10 py-5 text-[12px] font-bold uppercase tracking-widest text-stone-500 border-t border-rose-50/50">
            <button onclick="showPage('home')" class="nav-link active" id="nav-home">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
            <button onclick="showPage('shop')" class="nav-link" id="nav-shop">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
            <button onclick="showPage('contact')" class="nav-link" id="nav-contact">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</button>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-12 min-h-screen">
        
        <!-- PAGE: HOME -->
        <div id="page-home" class="page show animate-fade">
            <div class="relative h-[500px] rounded-[60px] overflow-hidden shadow-2xl mb-24 group">
                <img src="https://images.unsplash.com/photo-1490481651871-ab68de25d43d?w=1200" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-rose-200/40 via-transparent flex items-center px-12">
                    <div class="bg-white/80 backdrop-blur-xl p-14 rounded-[50px] max-w-lg shadow-2xl border border-white/50">
                        <h4 class="text-rose-400 font-bold tracking-[0.3em] text-[10px] mb-6 uppercase">Exclusive New Arrivals</h4>
                        <h2 class="text-6xl font-sriracha text-stone-800 mb-6 leading-tight">Sweet & Modern</h2>
                        <button onclick="showPage('shop')" class="btn-sweet px-12 py-5 text-xs font-bold uppercase">‡∏ä‡πâ‡∏≠‡∏õ‡πÄ‡∏•‡∏¢‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</button>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-between items-end mb-12 px-4">
                <div>
                    <h3 class="text-4xl font-sriracha text-stone-800">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (Best Seller)</h3>
                    <p class="text-rose-300 text-sm italic mt-2 uppercase tracking-widest font-bold">Recommended just for you</p>
                </div>
                <button onclick="showPage('shop')" class="bg-white text-rose-400 px-6 py-3 rounded-full text-xs font-bold shadow-sm hover:shadow-lg transition-all">‡∏î‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <i class="fas fa-chevron-right ml-2"></i></button>
            </div>
            <div id="homeGrid" class="grid grid-cols-2 lg:grid-cols-5 gap-6"></div>
        </div>

        <!-- PAGE: SHOP -->
        <div id="page-shop" class="page animate-fade">
            <div class="flex flex-col lg:flex-row gap-16">
                <aside class="w-full lg:w-72">
                    <div class="bg-white/80 backdrop-blur-md p-10 rounded-[50px] shadow-sm border border-rose-50 sticky top-32">
                        <h3 class="font-sriracha text-3xl text-rose-500 mb-8 pb-4 border-b-2 border-rose-50">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                        <div class="flex flex-col gap-6 text-sm font-bold text-stone-400" id="categoryFilter">
                            <button onclick="filterCat('‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')" class="text-left hover:text-rose-500 active-cat">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            <button onclick="filterCat('‡πÄ‡∏™‡∏∑‡πâ‡∏≠')" class="text-left hover:text-rose-500">‡πÄ‡∏™‡∏∑‡πâ‡∏≠</button>
                            <button onclick="filterCat('‡πÄ‡∏î‡∏£‡∏™')" class="text-left hover:text-rose-500">‡πÄ‡∏î‡∏£‡∏™</button>
                            <button onclick="filterCat('‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á')" class="text-left hover:text-rose-500">‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á</button>
                            <button onclick="filterCat('‡∏Å‡∏£‡∏∞‡πÇ‡∏õ‡∏£‡∏á')" class="text-left hover:text-rose-500">‡∏Å‡∏£‡∏∞‡πÇ‡∏õ‡∏£‡∏á</button>
                        </div>
                    </div>
                </aside>
                <div class="flex-1">
                    <div class="flex justify-between items-center mb-12">
                        <h2 id="currentCatTitle" class="text-4xl font-sriracha text-stone-800">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                        <p id="itemCount" class="text-[11px] text-rose-300 font-bold uppercase bg-white px-5 py-2 rounded-full shadow-sm"></p>
                    </div>
                    <div id="shopGrid" class="grid grid-cols-2 lg:grid-cols-3 gap-12"></div>
                </div>
            </div>
        </div>

        <!-- PAGE: DETAIL -->
        <div id="page-detail" class="page animate-fade">
            <div id="detailContent"></div>
        </div>

        <!-- PAGE: CART -->
        <div id="page-cart" class="page animate-fade max-w-5xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-sriracha text-stone-800 tracking-tighter">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
                <p id="cartItemsLabel" class="text-rose-300 text-sm mt-4 font-bold uppercase"></p>
            </div>
            <div id="cartList" class="space-y-8"></div>
            <div id="cartSummary" class="bg-white p-12 rounded-[60px] shadow-2xl border-2 border-rose-50 flex flex-col md:flex-row justify-between items-center gap-10 mt-16" style="display: none;">
                <div>
                    <p class="text-stone-400 text-xs font-bold uppercase mb-2">‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</p>
                    <h3 id="totalDisplay" class="text-6xl font-bold text-rose-500 tracking-tighter">‡∏ø0</h3>
                </div>
                <button onclick="checkout()" class="bg-stone-900 text-white px-16 py-6 rounded-full text-xs font-bold uppercase tracking-[0.3em] hover:bg-rose-600 transition-all">Confirm Order (LINE)</button>
            </div>
        </div>

        <!-- PAGE: CONTACT -->
        <div id="page-contact" class="page animate-fade max-w-4xl mx-auto">
            <div class="text-center mb-24">
                <h2 class="text-6xl font-sriracha text-stone-800">Contact Us</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
                <a id="linkFB" href="#" target="_blank" class="bg-white p-12 rounded-[60px] shadow-sm border border-rose-50 text-center hover:-translate-y-3 transition-all">
                    <div class="w-20 h-20 bg-blue-50 text-blue-500 rounded-[30px] flex items-center justify-center mx-auto mb-8 shadow-sm"><i class="fab fa-facebook text-4xl"></i></div>
                    <h4 class="font-bold text-xs uppercase mb-3">Facebook</h4>
                    <p id="textFB" class="text-[11px] text-stone-400"></p>
                </a>
                <a id="linkLine" href="#" target="_blank" class="bg-white p-12 rounded-[60px] shadow-sm border border-rose-50 text-center hover:-translate-y-3 transition-all">
                    <div class="w-20 h-20 bg-green-50 text-green-500 rounded-[30px] flex items-center justify-center mx-auto mb-8 shadow-sm"><i class="fab fa-line text-4xl"></i></div>
                    <h4 class="font-bold text-xs uppercase mb-3">Line ID</h4>
                    <p id="textLineID" class="text-[11px] text-stone-400"></p>
                </a>
                <a id="linkPhone" href="#" class="bg-white p-12 rounded-[60px] shadow-sm border border-rose-50 text-center hover:-translate-y-3 transition-all">
                    <div class="w-20 h-20 bg-rose-50 text-rose-500 rounded-[30px] flex items-center justify-center mx-auto mb-8 shadow-sm"><i class="fas fa-phone-alt text-4xl"></i></div>
                    <h4 class="font-bold text-xs uppercase mb-3">Call Center</h4>
                    <p id="textPhone" class="text-[11px] text-stone-400"></p>
                </a>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-white py-24 border-t border-rose-50 mt-20 relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-6 flex flex-col items-center">
            <h2 class="text-5xl font-sriracha text-rose-500 mb-8">Praewa Fashion</h2>
            <p class="text-stone-400 text-sm max-w-sm text-center leading-relaxed mb-12 italic">
                "‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏Å"
            </p>
            <div class="flex gap-10 mb-20">
                <a id="footFB" href="#" target="_blank" class="text-stone-300 hover:text-rose-500 text-2xl transition-all hover:scale-125"><i class="fab fa-facebook"></i></a>
                <a id="footLine" href="#" target="_blank" class="text-stone-300 hover:text-rose-500 text-2xl transition-all hover:scale-125"><i class="fab fa-line"></i></a>
                <a id="footPhone" href="#" class="text-stone-300 hover:text-rose-500 text-2xl transition-all hover:scale-125"><i class="fas fa-phone-alt"></i></a>
            </div>
            <div class="text-[10px] uppercase tracking-[0.4em] text-stone-300 font-bold">
                <h3 id="formTitle" class="text-2xl font-sriracha">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                <button onclick="closeModals()"><i class="fas fa-times text-2xl"></i></button>
            </div>
            <form id="pForm" class="p-10 space-y-6 overflow-y-auto flex-1">
                <input type="hidden" id="p_id">
                <div><label class="text-[10px] font-bold text-stone-400 uppercase mb-2 block">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label><input type="text" id="p_name" required class="w-full bg-stone-50 p-4 rounded-2xl outline-none border focus:border-rose-300"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div><label class="text-[10px] font-bold text-stone-400 uppercase mb-2 block">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ø)</label><input type="number" id="p_price" required class="w-full bg-stone-50 p-4 rounded-2xl outline-none"></div>
                    <div><label class="text-[10px] font-bold text-stone-400 uppercase mb-2 block">‡∏™‡∏ï‡πä‡∏≠‡∏Å</label><input type="number" id="p_stock" required class="w-full bg-stone-50 p-4 rounded-2xl outline-none"></div>
                </div>
                <div><label class="text-[10px] font-bold text-stone-400 uppercase mb-2 block">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                    <select id="p_cat" class="w-full bg-stone-50 p-4 rounded-2xl outline-none">
                        <option value="‡πÄ‡∏™‡∏∑‡πâ‡∏≠">‡πÄ‡∏™‡∏∑‡πâ‡∏≠</option>
                        <option value="‡πÄ‡∏î‡∏£‡∏™">‡πÄ‡∏î‡∏£‡∏™</option>
                        <option value="‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á">‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á</option>
                        <option value="‡∏Å‡∏£‡∏∞‡πÇ‡∏õ‡∏£‡∏á">‡∏Å‡∏£‡∏∞‡πÇ‡∏õ‡∏£‡∏á</option>
                    </select>
                </div>
                <div><label class="text-[10px] font-bold text-stone-400 uppercase mb-2 block">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (URL)</label><input type="text" id="p_img" class="w-full bg-stone-50 p-4 rounded-2xl outline-none"></div>
                <div><label class="text-[10px] font-bold text-stone-400 uppercase mb-2 block">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label><textarea id="p_desc" class="w-full bg-stone-50 p-4 rounded-2xl outline-none h-32"></textarea></div>
                <button type="submit" id="submitBtn" class="btn-sweet w-full py-5 font-bold uppercase text-xs">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </form>
        </div>
    </div>

    <!-- Contact Settings -->
    <div id="settingsModal" class="modal-overlay">
        <div class="modal-content">
            <h3 class="text-3xl font-sriracha mb-10 text-stone-800 text-center">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô</h3>
            <div class="space-y-6">
                <div><label class="text-[10px] font-bold uppercase text-stone-400 mb-2 block">Facebook Link ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏à</label><input type="text" id="s_fb" class="w-full bg-stone-50 p-4 rounded-2xl outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô https://fb.com/... ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏à"></div>
                <div><label class="text-[10px] font-bold uppercase text-stone-400 mb-2 block">Line ID ‡∏´‡∏£‡∏∑‡∏≠ ‡∏•‡∏¥‡∏á‡∏Å‡πå</label><input type="text" id="s_line" class="w-full bg-stone-50 p-4 rounded-2xl outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô @praewa ‡∏´‡∏£‡∏∑‡∏≠ https://lin.ee/..."></div>
                <div><label class="text-[10px] font-bold uppercase text-stone-400 mb-2 block">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label><input type="text" id="s_phone" class="w-full bg-stone-50 p-4 rounded-2xl outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô 081-xxx-xxxx"></div>
                <button onclick="saveStoreSettings()" class="btn-sweet w-full py-5 font-bold uppercase text-xs mt-6">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
            <button onclick="closeModals()" class="w-full mt-6 text-stone-300 text-xs font-bold uppercase">Cancel</button>
        </div>
    </div>

    <script>
        // ==========================================
        // üå∏ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API URL ‡∏ñ‡∏≤‡∏ß‡∏£‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üå∏
        // ==========================================
        const HARDCODED_API_URL = "https://script.google.com/macros/s/AKfycbzexSWRpW2nAsIGUCuMxlg3KZ1uXEmqU7iyGhTukN1wGZ0SDB6VtP14an-o8W4z1miw/exec";
        // ==========================================

        let products = [];
        let storeSettings = { facebook: '#', line: '@praewa', phone: '081-XXX-XXXX' };
        let cart = [];
        let isAdmin = false;
        let activeCat = '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
        let searchQuery = '';
        let currentDetailId = null;
        let apiUrl = localStorage.getItem('praewa_api_url') || HARDCODED_API_URL;

        window.onload = async () => {
            if (apiUrl) {
                await fetchData();
                setInterval(fetchData, 30000);
            }
            else renderProducts();
        };

        async function fetchData() {
            if (!apiUrl) return;
            try {
                const res = await fetch(apiUrl);
                const data = await res.json();
                products = data.products || [];
                if (data.settings) storeSettings = data.settings;
                updateContactUI();
                renderProducts();
                
                if (currentDetailId && document.getElementById('page-detail').classList.contains('show')) {
                    viewDetail(currentDetailId);
                }
            } catch (e) {
                console.error("Fetch failed:", e);
            }
        }

        function getAvailableStock(product) {
            const inCartCount = cart.filter(c => c.ID === product.ID).length;
            return product.Stock - inCartCount;
        }

        function updateContactUI() {
            // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ .trim() ‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô undefined ‡∏´‡∏£‡∏∑‡∏≠ null
            let fbLink = (storeSettings.facebook || '').trim();
            if (fbLink && !fbLink.startsWith('http')) {
                fbLink = `https://facebook.com/${fbLink}`;
            }

            let lineLink = (storeSettings.line || '').trim();
            if (lineLink && !lineLink.startsWith('http')) {
                lineLink = `https://line.me/ti/p/~${lineLink}`; 
            }

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Contact
            document.getElementById('linkFB').href = fbLink || '#';
            document.getElementById('linkLine').href = lineLink || '#';
            document.getElementById('linkPhone').href = `tel:${storeSettings.phone || ''}`;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Contact
            if(document.getElementById('textFB')) document.getElementById('textFB').innerText = storeSettings.facebook || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';
            if(document.getElementById('textLineID')) document.getElementById('textLineID').innerText = storeSettings.line || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';
            if(document.getElementById('textPhone')) document.getElementById('textPhone').innerText = storeSettings.phone || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô Footer
            if(document.getElementById('footFB')) document.getElementById('footFB').href = fbLink || '#';
            if(document.getElementById('footLine')) document.getElementById('footLine').href = lineLink || '#';
            if(document.getElementById('footPhone')) document.getElementById('footPhone').href = `tel:${storeSettings.phone || ''}`;
        }

        function renderProducts() {
            const filtered = products.filter(p => {
                const matchSearch = p.Name.toLowerCase().includes(searchQuery.toLowerCase()) || 
                                   p.Category.toLowerCase().includes(searchQuery.toLowerCase());
                const matchCat = activeCat === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î' || p.Category === activeCat;
                return matchSearch && matchCat;
            });

            const gridHtml = filtered.map(p => {
                const stock = getAvailableStock(p);
                return `
                <div class="product-card group relative flex flex-col animate-fade">
                    <div class="img-wrap cursor-pointer shadow-lg" onclick="viewDetail('${p.ID}')">
                        <img src="${p.Image || 'https://via.placeholder.com/400x533'}" alt="${p.Name}">
                        <div class="absolute top-4 left-4"><span class="tag-stock">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${stock} ‡∏ä‡∏¥‡πâ‡∏ô</span></div>
                        ${stock <= 0 ? '<div class="absolute inset-0 bg-stone-900/60 flex items-center justify-center backdrop-blur-sm"><span class="bg-white text-stone-800 px-6 py-2 rounded-full font-bold text-xs uppercase tracking-widest">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î</span></div>' : ''}
                    </div>
                    ${isAdmin ? `
                        <div class="absolute top-8 right-8 flex flex-col gap-3 z-10 opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="editItem('${p.ID}')" class="w-10 h-10 bg-white/90 text-blue-500 rounded-full shadow-lg flex items-center justify-center hover:bg-blue-500 hover:text-white transition-all"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteItem('${p.ID}')" class="w-10 h-10 bg-white/90 text-red-500 rounded-full shadow-lg flex items-center justify-center hover:bg-red-500 hover:text-white transition-all"><i class="fas fa-trash"></i></button>
                        </div>
                    ` : ''}
                    <div class="p-6 text-center">
                        <p class="text-[9px] uppercase tracking-widest text-rose-300 font-bold mb-1">${p.Category}</p>
                        <h4 class="text-sm font-medium text-stone-700 truncate mb-2">${p.Name}</h4>
                        <p class="text-rose-500 font-bold">‡∏ø${Number(p.Price).toLocaleString()}</p>
                        <button onclick="addToCart('${p.ID}')" class="mt-4 w-full py-3 rounded-2xl text-[10px] font-bold uppercase transition-all ${stock > 0 ? 'bg-rose-50 text-rose-400 hover:bg-rose-500 hover:text-white' : 'bg-stone-100 text-stone-300 cursor-not-allowed'}" ${stock <= 0 ? 'disabled' : ''}>
                            ${stock > 0 ? '‡πÉ‡∏™‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤' : '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß'}
                        </button>
                    </div>
                </div>
            `;}).join('');

            document.getElementById('shopGrid').innerHTML = gridHtml || '<p class="col-span-full py-32 text-center text-rose-200 italic font-sriracha text-2xl">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏∞...</p>';
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            const topProducts = [...products]
                .sort((a, b) => (Number(b.Sold) || 0) - (Number(a.Sold) || 0))
                .slice(0, 5);

            document.getElementById('homeGrid').innerHTML = topProducts.map(p => {
                const stock = getAvailableStock(p);
                return `
                <div class="product-card group relative bg-white/50 border-none shadow-none hover:shadow-xl transition-all">
                    <div class="img-wrap cursor-pointer" onclick="viewDetail('${p.ID}')">
                        <img src="${p.Image || 'https://via.placeholder.com/400x533'}" class="w-full h-full object-cover">
                        <div class="absolute top-4 left-4"><span class="tag-stock">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${stock} ‡∏ä‡∏¥‡πâ‡∏ô</span></div>
                        ${stock <= 0 ? '<div class="absolute inset-0 bg-stone-900/60 flex items-center justify-center backdrop-blur-sm"><span class="bg-white text-stone-800 px-6 py-2 rounded-full font-bold text-xs uppercase tracking-widest">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î</span></div>' : ''}
                    </div>
                    <div class="p-4 text-center">
                        <h4 class="text-xs font-medium truncate">${p.Name}</h4>
                        <p class="text-rose-500 font-bold text-sm">‡∏ø${Number(p.Price).toLocaleString()}</p>
                    </div>
                </div>
            `;}).join('');
            
            document.getElementById('itemCount').innerText = `‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${filtered.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
        }

        function viewDetail(id) {
            currentDetailId = id; 
            const p = products.find(x => x.ID == id);
            if (!p) return;
            
            const stock = getAvailableStock(p); 
            
            document.getElementById('detailContent').innerHTML = `
                <div class="bg-white rounded-[60px] overflow-hidden shadow-2xl flex flex-col md:flex-row border border-rose-50">
                    <div class="md:w-1/2 aspect-[4/5] overflow-hidden">
                        <img src="${p.Image}" class="w-full h-full object-cover">
                    </div>
                    <div class="md:w-1/2 p-8 md:p-16 flex flex-col justify-center">
                        <p class="text-[10px] font-bold text-stone-300 uppercase tracking-widest mb-4">Collection / ${p.Category}</p>
                        <h1 class="text-5xl font-sriracha text-stone-800 mb-6">${p.Name}</h1>
                        <p class="text-4xl text-rose-500 font-bold mb-8">‡∏ø${Number(p.Price).toLocaleString()}</p>
                        <div class="bg-rose-50/50 p-6 rounded-[30px] border border-rose-50 mb-10">
                            <h4 class="text-[11px] font-bold uppercase text-stone-400 mb-2">Product Info</h4>
                            <p class="text-sm text-stone-500 leading-relaxed whitespace-pre-line">${p.Description || '‡∏Ñ‡∏±‡∏î‡∏™‡∏£‡∏£‡∏ú‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡∏™‡∏ß‡∏°‡πÉ‡∏™‡πà‡∏™‡∏ö‡∏≤‡∏¢ ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ö‡∏∏‡∏Ñ‡∏•‡∏¥‡∏Å‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏î‡∏π‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô'}</p>
                            
                            <div class="mt-6 inline-flex items-center gap-2 bg-white px-4 py-2 rounded-full border border-rose-100 shadow-sm">
                                <div class="w-2 h-2 rounded-full ${stock > 0 ? 'bg-green-400 animate-pulse' : 'bg-red-400'}"></div>
                                <span class="text-[11px] font-bold text-stone-600">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á: <span class="text-rose-500">${stock}</span> ‡∏ä‡∏¥‡πâ‡∏ô</span>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <button onclick="addToCart('${p.ID}')" class="flex-1 btn-rose py-5 rounded-full font-bold text-xs uppercase tracking-widest shadow-2xl ${stock <= 0 ? 'opacity-50 pointer-events-none' : ''}" ${stock <= 0 ? 'disabled' : ''}>
                                ${stock > 0 ? 'Add to Bag (‡∏´‡∏¢‡∏¥‡∏ö‡πÉ‡∏™‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤)' : 'Out of Stock (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î)'}
                            </button>
                            <button onclick="showPage('shop')" class="w-16 h-16 bg-stone-50 rounded-full flex items-center justify-center text-stone-300 hover:text-rose-500 transition-all shadow-sm"><i class="fas fa-times text-xl"></i></button>
                        </div>
                    </div>
                </div>
            `;
            showPage('detail');
        }

        function addToCart(id) {
            const p = products.find(x => x.ID == id);
            if (p) { 
                if(getAvailableStock(p) <= 0) return alert("‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏°‡∏î‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ üôè");
                cart.push(p); 
                updateCartUI(); 
                
                renderProducts(); 
                if(currentDetailId === id) viewDetail(id);
                
                alert("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ üíñ"); 
            }
        }

        function updateCartUI() {
            const list = document.getElementById('cartList');
            const totalDisplay = document.getElementById('totalDisplay');
            const badge = document.getElementById('cartCount');
            let total = 0;

            if (cart.length === 0) {
                list.innerHTML = `<div class="bg-white p-24 rounded-[60px] text-center shadow-xl border border-rose-50"><i class="fas fa-shopping-bag text-5xl text-rose-100 mb-6"></i><p class="text-stone-400 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞</p><button onclick="showPage('shop')" class="mt-8 bg-stone-900 text-white px-10 py-3 rounded-full text-xs font-bold uppercase">Shop Now</button></div>`;
                document.getElementById('cartSummary').style.display = 'none';
                badge.style.display = 'none';
            } else {
                list.innerHTML = cart.map((item, i) => {
                    total += Number(item.Price);
                    return `<div class="bg-white p-6 md:p-8 rounded-[40px] shadow-sm border border-rose-50 flex items-center gap-8"><img src="${item.Image}" class="w-20 h-28 object-cover rounded-2xl shadow-md"><div class="flex-1"><p class="text-[10px] text-rose-300 font-bold mb-1">${item.Category}</p><h4 class="text-lg font-medium text-stone-700">${item.Name}</h4><p class="text-rose-500 font-bold mt-2">‡∏ø${Number(item.Price).toLocaleString()}</p></div><button onclick="removeFromCart(${i})" class="text-stone-200 hover:text-red-400 p-4 transition-all"><i class="fas fa-trash-alt text-xl"></i></button></div>`;
                }).join('');
                document.getElementById('cartSummary').style.display = 'flex';
                totalDisplay.innerText = `‡∏ø${total.toLocaleString()}`;
                badge.innerText = cart.length;
                badge.style.display = 'flex';
            }
            document.getElementById('cartItemsLabel').innerText = `‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${cart.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤`;
        }

        function removeFromCart(i) { 
            const removedId = cart[i].ID;
            cart.splice(i, 1); 
            updateCartUI(); 
            
            renderProducts(); 
            if(currentDetailId === removedId) viewDetail(removedId);
        }

        function checkout() {
            if (cart.length === 0) return;
            const msg = encodeURIComponent(`‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡πâ‡∏≤‡∏ô Praewa Fashion üõçÔ∏è\n\n‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:\n${cart.map((c, i) => `${i+1}. ${c.Name} (‡∏ø${Number(c.Price).toLocaleString()})`).join('\n')}\n\n‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô: ‡∏ø${cart.reduce((a,b) => a + Number(b.Price), 0).toLocaleString()}\n\n‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞ üíñ`);
            
            let lineLink = (storeSettings.line || '').trim();
            if (lineLink && !lineLink.startsWith('http')) {
                lineLink = `https://line.me/ti/p/~${lineLink}`;
            }
            
            const finalUrl = `${lineLink}${lineLink.includes('?') ? '&' : '?'}text=${msg}`;
            window.open(finalUrl, '_blank');
        }

        function toggleSearch() {
            const box = document.getElementById('searchBox');
            box.classList.toggle('open');
            if (box.classList.contains('open')) document.getElementById('searchInput').focus();
        }

        function handleSearch(val) {
            searchQuery = val;
            if (val.trim() !== "") showPage('shop');
            renderProducts();
        }

        function filterCat(cat) {
            activeCat = cat;
            document.getElementById('currentCatTitle').innerText = cat;
            document.querySelectorAll('#categoryFilter button').forEach(b => {
                b.classList.toggle('text-rose-500', b.innerText === cat);
                b.classList.toggle('translate-x-2', b.innerText === cat);
            });
            renderProducts();
        }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => {
                p.classList.remove('show');
                p.style.display = 'none';
            });
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            
            const page = document.getElementById(`page-${pageId}`);
            if(page) {
                page.classList.add('show');
                page.style.display = 'block';
            }
            const nav = document.getElementById(`nav-${pageId}`);
            if (nav) nav.classList.add('active');
            window.scrollTo(0,0);
        }

        function openLoginModal() { document.getElementById('loginModal').style.display = 'flex'; }
        function closeModals() { document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none'); }
        
        function doLogin() {
            if (document.getElementById('passInp').value === 'admin1234') {
                isAdmin = true;
                document.getElementById('adminBar').classList.add('active');
                closeModals();
                renderProducts();
                alert("‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏Ñ‡πà‡∏∞ ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô üå∏");
            } else alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        }

        function logoutAdmin() { isAdmin = false; document.getElementById('adminBar').classList.remove('active'); renderProducts(); }

        function openProductModal() {
            document.getElementById('pForm').reset();
            document.getElementById('p_id').value = "";
            document.getElementById('formTitle').innerText = "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏•‡∏á Excel";
            document.getElementById('submitBtn').innerText = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Excel";
            document.getElementById('productModal').style.display = 'flex';
        }

        function editItem(id) {
            const p = products.find(x => x.ID == id);
            document.getElementById('p_id').value = p.ID;
            document.getElementById('p_name').value = p.Name;
            document.getElementById('p_price').value = p.Price;
            document.getElementById('p_stock').value = p.Stock;
            document.getElementById('p_cat').value = p.Category;
            document.getElementById('p_img').value = p.Image;
            document.getElementById('p_desc').value = p.Description || "";
            document.getElementById('formTitle').innerText = "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏î‡∏¥‡∏°";
            document.getElementById('submitBtn').innerText = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç";
            document.getElementById('productModal').style.display = 'flex';
        }

        document.getElementById('pForm').onsubmit = async (e) => {
            e.preventDefault();
            const id = document.getElementById('p_id').value;
            const payload = {
                action: id ? 'edit' : 'add',
                id: id || "ID" + Date.now(),
                name: document.getElementById('p_name').value,
                price: document.getElementById('p_price').value,
                stock: document.getElementById('p_stock').value,
                category: document.getElementById('p_cat').value,
                image: document.getElementById('p_img').value,
                description: document.getElementById('p_desc').value
            };
            showLoader(true);
            try {
                await fetch(apiUrl, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) });
                setTimeout(async () => { 
                    await fetchData(); 
                    closeModals(); 
                    alert("‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"); 
                    showLoader(false);
                }, 1500);
            } catch(err) {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å");
                showLoader(false);
            }
        };

        async function deleteItem(id) {
            if (!confirm("‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Excel?")) return;
            showLoader(true);
            await fetch(apiUrl, { method: 'POST', mode: 'no-cors', body: JSON.stringify({ action: 'delete', id }) });
            setTimeout(async () => { 
                await fetchData(); 
                alert("‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"); 
                showLoader(false);
            }, 1500);
        }

        function openSettingsModal() {
            document.getElementById('s_fb').value = storeSettings.facebook || '';
            document.getElementById('s_line').value = storeSettings.line || '';
            document.getElementById('s_phone').value = storeSettings.phone || '';
            document.getElementById('settingsModal').style.display = 'flex';
        }

        async function saveStoreSettings() {
            const payload = {
                action: 'save_settings',
                facebook: document.getElementById('s_fb').value,
                line: document.getElementById('s_line').value,
                phone: document.getElementById('s_phone').value
            };
            showLoader(true);
            await fetch(apiUrl, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) });
            setTimeout(async () => { 
                await fetchData(); 
                closeModals(); 
                alert("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞"); 
                showLoader(false);
            }, 1500);
        }

        function changeApi() {
            const url = prompt("‡∏ß‡∏≤‡∏á Deployment URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:", apiUrl);
            if (url) { apiUrl = url; localStorage.setItem('praewa_api_url', url); fetchData(); }
        }

        function showLoader(s) { document.getElementById('globalLoader').style.display = s ? 'flex' : 'none'; }
    </script>
</body>
</html>
